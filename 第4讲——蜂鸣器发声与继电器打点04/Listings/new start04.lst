C51 COMPILER V9.60.0.0   NEW_START04                                                       04/30/2022 00:44:32 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE NEW_START04
OBJECT MODULE PLACED IN .\Objects\new start04.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE new start04.c OPTIMIZE(8,SPEED) BROWSE DEBUG OBJECTEXTEND PRINT(.\Listin
                    -gs\new start04.lst) OBJECT(.\Objects\new start04.obj)

line level    source

   1          /***************************************
   2          *GB2312
   3          *作者：创客海
   4          *内容：蜂鸣器项目理论课-单片机音乐-孤勇者-录课时编写
   5          *实验板：新起点51单片机实验板
   6          *单片机型号：STC89C52RC
   7          ***************************************/
   8          
   9          #include <STC89C5xRC.H>
  10          #include <INTRINS.H>
  11          
  12          #define B6N 19
  13          #define B7N 21
  14          #define B1H 23
  15          #define B2H 24
  16          #define B3H 26
  17          #define B4H 28
  18          #define B5H 29
  19          #define B6H 31
  20          
  21          sbit FM = P2^3;
  22          sbit JDQ = P3^6;//继电器新版本的硬件从P3.7改动到了P3.6
  23          
  24          
  25          
  26          //unsigned int music_table[] = {262,277,294,311,329,349,370,392,415,440,466,494};
  27          
  28          unsigned int code music_table[] = {130,139,147,156,165,175,185,196,208,220,233,247,//0-11
  29                                             262,277,294,311,329,349,370,392,415,440,466,494,//12-23
  30                                             523,554,587,622,659,698,740,784,830,880,932,988,0
  31                                            };//24-35
  32          
  33          unsigned char code music[] = {B6N,B7N,B1H,B2H,B7N,B1H,B1H,36,
  34                                        //爱  你  孤  身  走 暗  巷
  35                                        B1H,B7N,B1H,B2H,B7N,B1H,B1H,36,
  36                                        //爱 你  不  跪  的  模  样
  37                                        B1H,B2H,B3H,B2H,B3H,B2H,B3H,36,
  38                                        //爱 你  对  峙  过  绝  望
  39                                        B3H,B2H,B3H,36,B5H,B5H,B3H,36,36,
  40                                        //不 肯  哭      一      场
  41                                        B6N,B7N,B1H,B2H,B7N,B1H,B1H,36,
  42                                        //爱 你  破  烂  的 衣  裳
  43                                        B1H,B7N,B1H,B2H,B7N,B1H,B1H,36,
  44                                        //却 敢  赌  命  运 的  枪
  45                                        B1H,B2H,B3H,B2H,B3H,B2H,B3H,36,
  46                                        //爱 你  和  我  那  么  像
  47                                        B3H,B2H,B3H,36,B5H,B5H,B3H,36,36,
  48                                        //缺 口  都     一      样
  49                                        B5H,B3H,B3H,36,36,B5H,B3H,36,36,
  50                                        //去 吗            配  吗
  51                                        B5H,B3H,B5H,B6H,B3H,B5H,36,
  52                                        //这 褴  褛  的  披  风
  53                                        B5H,B3H,B5H,B3H, 36,
  54                                        //战  马  斩 啊
C51 COMPILER V9.60.0.0   NEW_START04                                                       04/30/2022 00:44:32 PAGE 2   

  55                                        B5H,B3H,B5H,B6H,B3H,B5H,36,
  56                                        //以  最  卑  微  的  梦
  57                                        B5H,B5H,B3H,B2H,B2H,B2H,B1H,B3H,B3H,B2H,B2H,B2H,B1H,B1H,B6N,36,36,
  58                                        //掷 那  黑      夜  中  的  呜          咽  与  怒  吼
  59                                        B5H,B5H,B3H,B2H,B2H,B2H,B1H,B3H,B3H,B2H,B2H,B2H,B1H,B1H,B6N,36,36,
  60                                        //谁 说  站      在  光  里  的              才  算  英  雄
  61                                       };
  62          
  63          void Delay50uss(unsigned char us)
  64          {
  65   1          unsigned char i;
  66   1          while(us--)
  67   1          {
  68   2              i = 6;
  69   2              while (--i);
  70   2          }
  71   1      }
  72          
  73          void main()
  74          {
  75   1          unsigned int i,j;
  76   1          unsigned int index,endindex;
  77   1          index =0;
  78   1          endindex = sizeof(music);
  79   1      
  80   1          while(1)
  81   1          {
  82   2              j= music_table[music[index]];
  83   2              i =j*3/5;//全音符*2，半音符*1
  84   2              while(i--)//发出音阶
  85   2              {
  86   3                  FM = !FM;//1.08us
  87   3                  Delay50uss(10000/j);
  88   3                  //50 0000/440 微秒 计算公式（1/262*1000*1000/2 ）
  89   3              }
  90   2              if(j == 0)//休止
  91   2              {
  92   3                  Delay50uss(10000*3/5);
  93   3                  JDQ = !JDQ;//节拍
  94   3              }
  95   2      
  96   2              index++;
  97   2              if(index>=endindex)index = 0;
  98   2          }
  99   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    137    ----
   CONSTANT SIZE    =    202    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----       6
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
